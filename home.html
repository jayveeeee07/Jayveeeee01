<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jayvee Hall of Mansion - Home</title>
<link rel="stylesheet" href="style.css">
<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', Arial, sans-serif;
    background: url('assets/bgindex.jpg') no-repeat center center fixed;
    background-size: cover;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    color: #fff;
  }

  header {
    background: rgba(0,0,0,0.7);
    text-align: center;
    padding: 20px;
    font-size: 28px;
    font-weight: bold;
    letter-spacing: 1px;
  }

  .home-container {
    flex: 1;
    max-width: 1200px;
    margin: 30px auto;
    background: rgba(0,0,0,0.55);
    padding: 25px;
    border-radius: 15px;
    text-align: center;
    box-shadow: 0 0 20px rgba(0,0,0,0.4);
    animation: fadeIn 0.8s;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(15px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .room-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-top: 20px;
  }

  .room-card {
    background: rgba(255,255,255,0.95);
    color: #222;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    transition: 0.3s;
    display: flex;
    flex-direction: column;
  }

  .room-card img {
    width: 100%;
    height: 180px;
    object-fit: cover;
  }

  .room-card:hover { transform: translateY(-5px); }
  .room-card h3 { margin: 12px 0 5px; }
  .room-card p { margin: 0 0 10px; font-weight: bold; }

  .card-buttons { margin-bottom: 15px; }
  .card-buttons button {
    margin: 5px;
    padding: 8px 14px;
    border: none;
    cursor: pointer;
    border-radius: 6px;
    background: #333;
    color: white;
    font-size: 14px;
    transition: 0.2s;
  }
  .card-buttons button:hover { background: #555; }

  /* Modal */
  .modal {
    display: none;
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.7);
    justify-content: center;
    align-items: center;
    z-index: 1000;
  }
  .modal-content {
    background: white;
    padding: 25px;
    border-radius: 12px;
    width: 420px;
    max-width: 90%;
    text-align: center;
    position: relative;
    animation: fadeIn 0.4s;
  }
  .modal-content h3 { color: #333; }
  .modal-content p { color: #555; }
  .close {
    position: absolute;
    top: 10px; right: 15px;
    font-size: 22px;
    cursor: pointer;
    color: #333;
  }

  /* Notifications */
  #notifications {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  .notif {
    padding: 12px 20px;
    border-radius: 8px;
    color: white;
    opacity: 0;
    transform: translateX(100%);
    animation: slideIn 0.5s forwards, fadeOut 0.5s forwards 4.5s;
    font-weight: bold;
  }
  .notif.approved { background-color: #4CAF50; }
  .notif.rejected { background-color: #F44336; }
  .notif.info { background-color: #2196F3; }

  @keyframes slideIn {
    to { opacity: 1; transform: translateX(0); }
  }
  @keyframes fadeOut {
    to { opacity: 0; transform: translateX(50%); }
  }

  /* Booking Status */
  .booking-status {
    background: rgba(255,255,255,0.95);
    color: black;
    margin: 15px auto;
    padding: 15px;
    border-radius: 10px;
    max-width: 600px;
    box-shadow: 0 3px 10px rgba(0,0,0,0.3);
  }

  @media (max-width: 768px) {
    header { font-size: 22px; }
    .room-card img { height: 150px; }
  }
</style>
</head>
<body>

<header>JAYVEE HALL OF MANSION</header>

<div class="home-container">
  <p>Experience luxury and comfort in Malungon, Sarangani. Explore our rooms and choose your perfect stay.</p>

  <div class="room-grid" id="roomGrid"></div>

  <h3>Your Bookings:</h3>
  <div id="userBookings"></div>
</div>

<!-- Room Modal -->
<div id="roomModal" class="modal">
  <div class="modal-content">
    <span class="close" id="closeModal">&times;</span>
    <h3 id="roomTitle"></h3>
    <p id="roomDesc"></p>
    <p id="roomPrice"></p>
    <button id="interestedBtn">Interested</button>
    <button id="notInterestedBtn">Not Interested</button>
  </div>
</div>

<!-- Notifications -->
<div id="notifications"></div>

<footer style="background: rgba(0,0,0,0.8); color: #fff; text-align: center; padding: 15px 10px; margin-top: auto;">
  <div style="max-width: 1200px; margin: auto;">
    <p style="margin: 5px 0; font-size: 14px;">© 2025 Jayvee Hall of Mansion. All Rights Reserved.</p>
    <p style="margin: 5px 0; font-weight: bold;">JHOM</p>
  </div>
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyCdMcz7H8k5QjQikD6ZAlf7kHw7BbUBO70",
  authDomain: "jayveehallofmansion.firebaseapp.com",
  databaseURL: "https://jayveehallofmansion-default-rtdb.firebaseio.com",
  projectId: "jayveehallofmansion",
  storageBucket: "jayveehallofmansion.firebasestorage.app",
  messagingSenderId: "596113378063",
  appId: "1:596113378063:web:ae6fa08175627727660c7a",
  measurementId: "G-LY9QYJKZMX"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const roomDetails = [
  { title: "Room 101 - Deluxe Room", desc: "Our Deluxe Room offers comfort and elegance with a cozy king-size bed, Wi-Fi, and modern bathroom.", price: "₱3,500 / night" },
  { title: "Room 102 - Executive Suite", desc: "Executive Suite provides luxurious experience with spacious interiors, private lounge, and premium amenities.", price: "₱5,200 / night" },
  { title: "Room 103 - Family Room", desc: "Family Room is designed for groups and families, featuring multiple beds and entertainment options.", price: "₱4,000 / night" },
  { title: "Room 104 - Presidential Suite", desc: "Presidential Suite offers majestic views, large living room, Jacuzzi, and VIP services.", price: "₱8,000 / night" }
];

const roomGrid = document.getElementById("roomGrid");
const roomModal = document.getElementById("roomModal");
const roomTitle = document.getElementById("roomTitle");
const roomDesc = document.getElementById("roomDesc");
const roomPrice = document.getElementById("roomPrice");
const closeModal = document.getElementById("closeModal");
const interestedBtn = document.getElementById("interestedBtn");
const notInterestedBtn = document.getElementById("notInterestedBtn");
const notifContainer = document.getElementById("notifications");
let selectedRoom = "";

// Render room cards
roomDetails.forEach((room, index) => {
  const card = document.createElement("div");
  card.className = "room-card";
  card.innerHTML = `
    <img src="assets/room${index+1}.jpg" alt="${room.title}">
    <h3>${room.title}</h3>
    <p>${room.price}</p>
    <div class="card-buttons">
      <button class="viewBtn">View Details</button>
      <button class="bookBtn">Book Now</button>
    </div>
  `;
  roomGrid.appendChild(card);

  card.querySelector(".viewBtn").addEventListener("click", () => {
    selectedRoom = room.title;
    roomTitle.innerText = room.title;
    roomDesc.innerText = room.desc;
    roomPrice.innerText = room.price;
    roomModal.style.display = "flex";
  });

  card.querySelector(".bookBtn").addEventListener("click", () => {
    window.location.href = `booking.html?room=${encodeURIComponent(room.title)}`;
  });
});

// Modal buttons
closeModal.addEventListener("click", () => roomModal.style.display = "none");
notInterestedBtn.addEventListener("click", () => roomModal.style.display = "none");
interestedBtn.addEventListener("click", () => {
  window.location.href = `booking.html?room=${encodeURIComponent(selectedRoom)}`;
});

// Notifications
function showNotification(message, type="info") {
  const div = document.createElement("div");
  div.className = `notif ${type}`;
  div.innerText = message;
  notifContainer.appendChild(div);
  setTimeout(() => div.remove(), 5000);
}

function loadNotifications() {
  const bookings = JSON.parse(localStorage.getItem("bookings")) || [];
  bookings.forEach(b => {
    if (b.status === "Approved" || b.status === "Rejected") {
      showNotification(`Your booking for ${b.room} was ${b.status}`, b.status === "Approved" ? "approved" : "rejected");
    }
  });
}

// User bookings from Firebase
const userEmail = localStorage.getItem("userEmail");
const userBookingsDiv = document.getElementById("userBookings");

function renderBooking(booking) {
  return `
    <div class="booking-status">
      <strong>Room:</strong> ${booking.room}<br>
      <strong>Date:</strong> ${booking.date || "N/A"}<br>
      <strong>Status:</strong> ${booking.status}
    </div>
  `;
}

if (userEmail) {
  const bookingsRef = ref(db, 'bookings');
  onValue(bookingsRef, (snapshot) => {
    userBookingsDiv.innerHTML = "";
    const data = snapshot.val();
if (data) {
      Object.values(data).forEach(booking => {
        if (booking.email === userEmail) {
          userBookingsDiv.innerHTML += renderBooking(booking);
        }
      });
    }
  });
} else {
  userBookingsDiv.innerHTML = "<p>Please log in to see your bookings.</p>";
}

// Load notifications for approved/rejected bookings
loadNotifications();

// Close modal when clicking outside content
window.addEventListener("click", (e) => {
  if (e.target === roomModal) roomModal.style.display = "none";
});
</script>

</body>
</html>
